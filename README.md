# unittest_framework

Framework for unittesting Python modules to detect unintended changes between versions.

## Tutorial

**Scenario:** You have an `old_version.py` and a `new_version.py` of your module, and you want to ensure the new version behaves identically to the old one.

**Files:**

1.  **`old_version.py`:**

    ```python
    def add(x, y):
        return x + y

    def add_1(x):
        return x + 1
    ```

2.  **`new_version.py`:**

    ```python
    import operator

    def add(x, y):
        return operator.add(x, y)

    def add_1(x):
        return operator.add(x, 1)
    ```

3.  **`function_args.py`:** (Test cases for your functions)

    ```python
    function_args = {
        'add': [
            (1, 2), 
            (5, 9)
        ],
        'add_1': [
            (5,), 
            (6,),
            (9,)
        ]
    }
    ```

**Steps:**

1.  **Generate Test Results for the Old Version:**

    Use the `mapfunc.py` script to run the old version of your module with the specified test cases and store the results in a pickle file.

    ```bash
    python mapfunc.py --module old_version.py --function_args function_args.py --output output.pkl
    ```

    **`mapfunc.py` Usage:**

    ```
    usage: mapfunc.py [-h] --module MODULE --function_args FUNCTION_ARGS --output OUTPUT

    Map function outputs and save to pickle.

    options:
      -h, --help            show this help message and exit
      --module MODULE       Path to the Python file (e.g., /path/to/my_module.py)
      --function_args FUNCTION_ARGS
                            Path to the Python file containing the 'function_args' dictionary
      --output OUTPUT       Output pickle file path
    ```

2.  **Verify Test Results for the New Version:**

    Use the `testmap.py` script to run the new version of your module with the same test cases and compare the results to the stored results from the old version.

    ```bash
    python main/testmap.py --module new_version.py --input output.pkl
    ```

    **`testmap.py` Usage:**

    ```
    usage: testmap.py [-h] --module MODULE --input INPUT

    Unit test loaded func results

    options:
      -h, --help      show this help message and exit
      --module MODULE Path to the Python file (e.g., /path/to/my_module.py)
      --input INPUT   Input pickle file path
    ```

**Explanation:**

* **`mapfunc.py`:**
    * This script takes the old version of your module, the test cases, and an output file path.
    * It executes each function in the module with the specified test cases and stores the function names, arguments, and return values in a pickle file.
* **`testmap.py`:**
    * This script takes the new version of your module and the pickle file generated by `mapfunc.py`.
    * It executes the new version of the module with the same test cases and compares the results to the stored results from the old version.
    * Any discrepancies between the old and new version will be reported.
